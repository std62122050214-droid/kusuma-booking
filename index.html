<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåª ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å - ‡πÑ‡∏£‡πà‡∏Å‡∏∏‡∏™‡∏∏‡∏°‡∏≤ 2568</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; background: linear-gradient(135deg, #FEF3C7 0%, #FCD34D 50%, #F59E0B 100%); }
        .room-card { cursor:pointer; transition: 0.3s; padding:20px; border-radius:12px; color:white; text-align:center; }
        .room-card:hover { transform: translateY(-2px); box-shadow:0 10px 25px rgba(0,0,0,0.1);}
        .available { background: #10B981; } .partial { background: #F59E0B; } .full { background: #EF4444; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">

<div id="login-prompt" class="text-center p-8 bg-white rounded-xl shadow-lg">
    <h1 class="text-2xl font-bold text-gray-800 mb-2">üåª ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å</h1>
    <p class="text-gray-600 mb-6">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏±‡∏ç‡∏ä‡∏µ Google ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
    <button id="prompt-login-btn" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏î‡πâ‡∏ß‡∏¢ Google</button>
</div>

<div id="main-content" class="hidden max-w-4xl mx-auto p-4 w-full">
    <div class="text-right mb-4">
        <span id="user-display" class="font-semibold text-gray-700"></span>
        <button id="logout-btn" class="hidden ml-4 bg-red-600 text-white font-bold py-1 px-3 rounded-lg text-sm">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>
    <div id="rooms-container" class="grid grid-cols-2 md:grid-cols-4 gap-4"></div>
</div>

<script type="module">
    // Import functions from the Firebase modular SDK
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, GoogleAuthProvider, signInWithRedirect, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyDDY7uIvV8rh7MJITAibsiOMZcttTaCMXo",
  authDomain: "kusuma-booking.firebaseapp.com",
  databaseURL: "https://kusuma-booking-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "kusuma-booking",
  storageBucket: "kusuma-booking.firebasestorage.app",
  messagingSenderId: "237116351910",
  appId: "1:237116351910:web:ace9e82ab57c76bdf95b67",
  measurementId: "G-Z510RRPZG6"
};

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getDatabase(app);
    const roomsRef = ref(db, 'rooms');

    // Get HTML Elements
    const loginPrompt = document.getElementById('login-prompt');
    const mainContent = document.getElementById('main-content');
    const userDisplay = document.getElementById('user-display');
    const logoutBtn = document.getElementById('logout-btn');
    const roomsContainer = document.getElementById('rooms-container');
    const loginBtn = document.getElementById('prompt-login-btn');

    // Login Logic
    const provider = new GoogleAuthProvider();
    loginBtn.addEventListener('click', () => {
        signInWithRedirect(auth, provider);
    });

    // Logout Logic
    logoutBtn.addEventListener('click', () => {
        signOut(auth);
    });

    // Authentication State Observer
    onAuthStateChanged(auth, user => {
        if (user) {
            // User is signed in
            loginPrompt.classList.add('hidden');
            mainContent.classList.remove('hidden');
            userDisplay.textContent = `‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, ${user.displayName}`;
            logoutBtn.classList.remove('hidden');
        } else {
            // User is signed out
            mainContent.classList.add('hidden');
            loginPrompt.classList.remove('hidden');
        }
    });

    // Realtime Database Listener
    onValue(roomsRef, (snapshot) => {
        const roomsData = snapshot.val();
        roomsContainer.innerHTML = ''; // Clear previous room display

        if (roomsData) {
            for (const roomName in roomsData) {
                const room = roomsData[roomName];
                const bookedCount = room.booked || 0;
                
                const roomCard = document.createElement('div');
                roomCard.className = 'room-card';

                if (bookedCount >= room.capacity) {
                    roomCard.classList.add('full');
                    roomCard.innerHTML = `<h3 class="font-bold">${roomName}</h3><p>‡πÄ‡∏ï‡πá‡∏°</p>`;
                } else if (bookedCount > 0) {
                    roomCard.classList.add('partial');
                    roomCard.innerHTML = `<h3 class="font-bold">${roomName}</h3><p>${bookedCount}/${room.capacity}</p>`;
                } else {
                    roomCard.classList.add('available');
                    roomCard.innerHTML = `<h3 class="font-bold">${roomName}</h3><p>‡∏ß‡πà‡∏≤‡∏á</p>`;
                }
                roomsContainer.appendChild(roomCard);
            }
        }
    });
</script>

</body>
</html>

